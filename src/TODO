code splitter

merge D3-800 (need code modification)
